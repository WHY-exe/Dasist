COM(Component Object Model)架构

C++编译器本质上被设计得更适合用源代码进行软件组件复用而非从二进制文件上经行软件组件复用，因为不同的编译器可能会期待并编译出组织结构不同的二进制文件，从而导致C++的二进制库(.lib和.dll文件)在不同编译器间可能无法通用。

为了解决这个问题微软提出了COM标准

COM中的每一个接口通过GUID（Global Unique Identifier）表示，客户通过COM工厂函数，传入GUID获得创建COM对象，获得指向该对象的指针，通过指针调用该对象的其他成员函数，这样就算COM对象的类实现发生了变化，但是客户依旧可以用COM接口创建COM对象

在COM中所有的接口都是IUnKnown接口。对于每一个COM对象，可以用AddRef()和Release()方法来增加或减少对于该对象的应用数(即指向该对象的指针数)，同时，每一个COM对象都维持者一个对象引用数，当调用AddRef时引用数加1，调用Release时引用数减1，当引用数为0时，COM会销毁该COM对象

IUnknown接口还有一个方法名为QueryInterface。该方法接收一个GUID和一个指向指针的指针作为参数，如果该GUID有效，那么该方法接受的指针将会接收GUID所指的接口实例

D3D11

D3D11的API基于COM设计。在D3D11中想要创建任何渲染系统对象都需要通过ID3D11Device对象，该对象负责为渲染系统的其它部分（对象）分配资源，IDXGISwapChain对象负责把渲染信息呈现到显示器上，ID3D11DeviceContext负责将渲染数据并入渲染管线并对渲染管线进行控制